<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Sociable Weaver - Editor</title>
    <script src="https://unpkg.com/htmx.org@1.9.6"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style type="text/tailwindcss">
        @layer base {
          h1 { @apply text-3xl font-bold mt-6 mb-4; }
          h2 { @apply text-2xl font-semibold mt-5 mb-3; }
          h3 { @apply text-xl font-semibold mt-4 mb-2; }
          h4 { @apply text-lg font-medium mt-3 mb-2; }

          p  { @apply mb-4 leading-relaxed; }

          ul { @apply list-disc list-inside mb-4; }
          ol { @apply list-decimal list-inside mb-4; }
          li { @apply mb-1; }

          a  { @apply text-blue-600 hover:underline; }

          table { @apply border-collapse border border-gray-300 w-full my-4; }
          th    { @apply border border-gray-300 bg-gray-100 px-3 py-1 text-left; }
          td    { @apply border border-gray-300 px-3 py-1; }

          blockquote { @apply border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4; }
          pre        { @apply bg-gray-100 p-3 rounded overflow-x-auto text-sm; }
          code       { @apply font-mono text-sm; }
        }
    </style>
</head>
<body>

<div class="border-b bg-white/80 backdrop-blur">
    <div class="mx-auto max-w-5xl px-4 py-2">
        <form id="playbook" class="flex items-center gap-2" method="get" th:action="@{/}">
            <label for="playbook-input" class="font-medium">Playbook:</label>
            <input id="playbook-input"
                   name="playbook"
                   type="text"
                   th:value="${playbook}"
                   class="flex-1 min-w-0 rounded border px-3 py-1.5"/>
            <button type="submit"
                    name="open"
                    class="rounded bg-blue-600 px-3 py-1.5 text-white hover:bg-blue-700">Open</button>
        </form>

        <div th:if="${warning}"
             id="warning"
             th:text="${warning}"
             class="mt-2 rounded border border-amber-200 bg-amber-50 px-2 py-1 text-sm text-amber-800"></div>
    </div>
</div>

<div id="entries" data-entries class="mx-auto max-w-5xl px-4 py-2">
    <th:block th:each="entry : ${entries}">
        <th:block th:replace="~{fragments/entry :: renderEntry(${entry})}"/>
    </th:block>
</div>

<script>
    function showFields(selectElement) {
        console.log('Toggle fields');
        const form = selectElement.closest("form");
        form.querySelectorAll("div[name=fields] .field").forEach(el => el.style.display = "none");
        form.querySelectorAll("div[name=fields] ." + selectElement.value).forEach(el => el.style.display = "block");
    }
</script>
</body>
</html>
